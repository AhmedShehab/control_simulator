{% extends 'main/layout.html' %} {% load static %} {% block head %}
<title>Cruise Control Simulator</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta http-equiv="x-ua-compatible" content="ie=edge" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.min.js"></script>
<link href="{% static 'main/css/cred.css' %}" rel="stylesheet" />
<link href="{% static 'main/css/profile.css' %}" rel="stylesheet" />
<link href="{% static 'main/css/simulator.css' %}" rel="stylesheet" />
<style>
	.flex-child {
		margin-top: 5%;
		flex: 0 70em;
	}

	.flex-child:first-child {
		border-right: 2px solid green;
		padding: 3% 5% 2% 4%;
		margin-right: 20px;
	}
</style>
{% endblock head %} {% block body %} {% if assignment.riseTime %}
<div class="{{assignment.id}}" style="display: none; position: fixed; background-color: rgba(0, 0, 0, 0.658); top: 0; left: 0; bottom: 0; right: 0">
	<div class="assign_child2">
		<h3>Assignment Requirements</h3>
		Rise Time = {{assignment.riseTime}}s
		<br />
		Settling Time = {{assignment.setTime}}s
		<br />
		Percent overshoot = {{assignment.pOvershoot}}%
		<br />
		steady state error = {{assignment.Ess}}
		<br />
		<button class="button" onclick="closeReqForm({{assignment.id}});">Exit</button>
	</div>
</div>
{% else %}
<div class="{{assignment.id}}" style="display: none; position: fixed; background-color: rgba(0, 0, 0, 0.658); top: 0; left: 0; bottom: 0; right: 0">
	<div class="assign_child2">
		<h3>Requirements Description</h3>
		<p>{{assignment.description}}</p>
		<br />
		<button class="button" onclick="closeReqForm({{assignment.id}});">Exit</button>
	</div>
</div>
{% endif %}
<div class="flex-container" style="display: flex">
	<div class="flex-child" id="simulatorForm" style="flex: 1">
		<form class="cred_form">
                        {% if assignment %}
                        <a class="btn draw" id="{{assignment.id}}" style="display: inline;" type="button" onclick="openReqForm({{assignment.id}});">
                                Assignment Requirements
                        </a>
                        {% endif %}
                        <div class="text1">
                                <p class="input-bar">Controller:</p> 
                        </div>
			<select class="cred" onchange="display();" id="selector">
                <option disabled selected>Not Selected</option>
				<option value="non" {% if remember == 'non' %}selected{% endif %}>Uncompensated</option>
				<option value="P" {% if remember == 'p' %}selected{% endif %}>P</option>
				<option value="PI" {% if remember == 'pi' %}selected{% endif %}>PI</option>
				<option value="PD" {% if remember == 'pd' %}selected{% endif %}>PD</option>
				<option value="PID" {% if remember == 'pid' %}selected{% endif %}>PID</option>
				<option value="lag" {% if remember == 'lag' %}selected{% endif %}>Lag</option>
				<option value="lead" {% if remember == 'lead' %}selected{% endif %}>Lead</option>
			</select>
			{% comment %} Dummy Form Temporary fix for some unknown bug {% endcomment %}
			<div id="dummy" style="display: none" class="option">
				<form class="cred_form" action="{% url 'cruise' %}" method="POST">
					{% csrf_token %}
					<button class="button" type="submit" name="submit" value="submit">Submit</button>
				</form>
			</div>
                        <div id="non" style="display: none" class="option">
                                <form class="cred_form" action="{% url 'cruise' %}" method="POST">
					{% csrf_token %}
                                        <div class="text1">
                                                <p class="input-bar">Set Point:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="setPoint" value="{{setPoint}}" />
                                        </div>
                                        <div class="text2">
                                                <p class="input-bar">Simulation Time:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="time" value="{{time}}" />
                                        </div>
                                        <input type="hidden" name="remember" value="non">
					<button class="button" type="submit" name="submit" value="simulate">Start</button>
					<button class="button" type="button" >Reset</button>
                                        {% if assignment %}
					<button class=" sub" type="submit" name="submit" value="submit">Submit</button>
					{% endif %}
				</form>   
                        </div>
			<div id="P" style="display: none" class="option">
				<form class="cred_form" action="{% url 'cruise' %}" method="POST">
					{% csrf_token %}
                                        <div class="text1">
                                                <p class="input-bar">Set Point:</p>
                                                <input class="input-data" type="number" min="0" step="0.00001" name="setPoint" value="{{setPoint}}" />
                                        </div>
                                        <div class="text2">
                                                <p class="input-bar">Simulation Time:</p>
                                                <input class="input-data" type="number" min="1" step="0.00001" name="time" value="{{time}}" />
                                        </div>
                                        <div class="text0">
                                                <p class="input-bar" style="margin-left: 10px;">P:</p>
                                                <input class="cred" type="number" step="0.00001" required name="p" placeholder="Enter a value" value="{{p}}" />
                                        </div>
                                        <input type="hidden" name="remember" value="p">
					<button class="button" type="submit" name="submit" value="simulate">Start</button>
					<button class="button" type="button" >Reset</button>
                                        {% if assignment %}
					<button class=" sub" type="submit" name="submit" value="submit">Submit</button>
					{% endif %}
				</form>
			</div>
			<div id="PI" style="display: none" class="option">
				<form class="cred_form" action="{% url 'cruise' %}" method="POST">
					{% csrf_token %}
                                        <div class="text1">
                                                <p class="input-bar">Set Point:</p>
                                                <input class="input-data" type="number" min="0" step="0.00001" name="setPoint" value="{{setPoint}}" />
                                        </div>
                                        <div class="text2">
                                                <p class="input-bar">Simulation Time:</p>
                                                <input class="input-data" type="number" min="1" step="0.00001" name="time" value="{{time}}" />
                                        </div>
                                        <br><br><br>
                                        <div class="text1">
                                                <p class="input-bar">P:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="p" value="{{p}}"/>
                                        </div>
					<div class="text2">
                                                <p class="input-bar">I:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="i" value="{{i}}"/>
                                        </div>
					<input type="hidden" name="remember" value="pi">
					<button class="button" type="submit" name="submit" value="simulate">Start</button>
					<button class="button" type="button" >Reset</button>
                                        {% if assignment %}
					<button class=" sub" type="submit" name="submit" value="submit">Submit</button>
					{% endif %}
				</form>
			</div>
			<div id="PD" style="display: none" class="option">
				<form class="cred_form" action="{% url 'cruise' %}" method="POST">
					{% csrf_token %}
                                        <div class="text1">
                                                <p class="input-bar">Set Point:</p>
                                                <input class="input-data" type="number" step="0.00001" min="0" name="setPoint" value="{{setPoint}}" />
                                        </div>
                                        <div class="text2">
                                                <p class="input-bar">Simulation Time:</p>
                                                <input class="input-data" type="number" step="0.00001" min="1" name="time" value="{{time}}" />
                                        </div>
					<br><br><br>
                                        <div class="text1">
                                                <p class="input-bar">P:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="p" value="{{p}}"/>
                                        </div>
					<div class="text2">
                                                <p class="input-bar">D:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="d" value="{{d}}"/>
                                        </div>
                                        <input type="hidden" name="remember" value="pd">
					<button class="button" type="submit" name="submit" value="simulate">Start</button>
					<button class="button" type="button" >Reset</button>
                                        {% if assignment %}
					<button class=" sub" type="submit" name="submit" value="submit">Submit</button>
					{% endif %}
				</form>
			</div>
			<div id="PID" style="display: none" class="option">
				<form class="cred_form" action="{% url 'cruise' %}" method="POST">
					{% csrf_token %}
                                        <div class="text1">
                                                <p class="input-bar">Set Point:</p>
                                                <input class="input-data" type="number" min="0" step="0.00001" name="setPoint" value="{{setPoint}}" />
                                        </div>
                                        <div class="text2">
                                                <p class="input-bar">Simulation Time:</p>
                                                <input class="input-data" type="number" min="1" step="0.00001" name="time" value="{{time}}" />
                                        </div>
                                        <br><br><br>
                                        <div class="text11">
                                                <p class="input-bar">P:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="p" value="{{p}}" />
                                        </div>
					<div class="text22">
                                                <p class="input-bar">I:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="i" value="{{i}}"/>
                                        </div>
                                        <div class="text33">
                                                <p class="input-bar">D:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="d" value="{{d}}"/>
                                        </div>
                                        <input type="hidden" name="remember" value="pid">
					<button class="button" type="submit" name="submit" value="simulate">Start</button>
					<button class="button" type="button" >Reset</button>
                                        {% if assignment %}
					<button class=" sub" type="submit" name="submit" value="submit">Submit</button>
					{% endif %}
				</form>
			</div>
			<div id="lag" style="display: none" class="option">
				<form class="cred_form" action="{% url 'cruise' %}" method="POST">
                                        {% csrf_token %}
                                        <div class="text1">
                                                <p class="input-bar">Set Point:</p>
                                                <input class="input-data" type="number" min="0" step="0.00001" name="setPoint" value="{{setPoint}}" />
                                        </div>
                                        <div class="text2">
                                                <p class="input-bar">Simulation Time:</p>
                                                <input class="input-data" type="number" min="1" step="0.00001" name="time" value="{{time}}" />
                                        </div>
                                        <br><br><br>
                                        <div class="text11">
                                                <p class="input-bar">Zero:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="zero" value="{{zero}}"/>
                                        </div>
					<div class="text22">
                                                <p class="input-bar">Pole:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="pole" value="{{pole}}"/>
                                        </div>
                                        <div class="text33">
                                                <p class="input-bar">Gain:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="gain" value="{{gain}}"/>
                                        </div>
                                        <input type="hidden" name="remember" value="lag">
					<button class="button" type="submit" name="submit" value="simulate">Start</button>
					<button class="button" type="button" >Reset</button>
                                        {% if assignment %}
					<button class=" sub" type="submit" name="submit" value="submit">Submit</button>
					{% endif %}
				</form>
			</div>
			<div id="lead" style="display: none" class="option">
				<form class="cred_form" action="{% url 'cruise' %}" method="POST">
                                        {% csrf_token %}
                                        <div class="text1">
                                                <p class="input-bar">Set Point:</p>
                                                <input class="input-data" type="number" min="0" step="0.00001" name="setPoint" value="{{setPoint}}" />
                                        </div>
                                        <div class="text2">
                                                <p class="input-bar">Simulation Time:</p>
                                                <input class="input-data" type="number" min="1" step="0.00001" name="time" value="{{time}}" />
                                        </div>
					<br><br><br>
                                        <div class="text11">
                                                <p class="input-bar">Zero:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="zero" value="{{zero}}"/>
                                        </div>
					<div class="text22">
                                                <p class="input-bar">Pole:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="pole" value="{{pole}}"/>
                                        </div>
                                        <div class="text33">
                                                <p class="input-bar">Gain:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="gain" value="{{gain}}"/>
                                        </div>
                                        <input type="hidden" name="remember" value="lead">
					<button class="button" type="submit" name="submit" value="simulate">Start</button>
					<button class="button" type="button" >Reset</button>
                                        {% if assignment %}
					<button class=" sub" type="submit" name="submit" value="submit">Submit</button>
					{% endif %}
				</form>
			</div>
                        <div style="text-align: center">
                                <a class="btn draw" href="{% url 'design' 'Crusie' %}">Design by Frequency</a>
                        </div>
		</form>
	</div>
	<div class="flex-child" style="text-align: center">
		<div>
			<h1>System Response</h1>
			<canvas id="myChart"></canvas>
		</div>
	</div>
</div>

<script src=" {% static 'main/script/chart.js' %}"></script>
<script src=" {% static 'main/script/student.js' %}"></script>
<script src=" {% static 'main/script/simulator.js' %}"></script>
<div class="desc" id="desc">
	<button id="descButton" class="descButton" onclick="run();">Show System Description<span class="arrowUp"></span></button>
	<div class="content">
		<iframe id="pdf" src="https://cloudpdf.io/document/aad2b22a-7d7f-47e7-ac84-db6abc6f0b2e"></iframe>
	</div>
</div>
<script>
	window.addEventListener("load", (event) => {
		if ("{{assignment.controller}}" != "") {
			document.getElementById("selector").value = "{{assignment.controller}}";
			display();
		}
	});
</script>
{% endblock body %}
