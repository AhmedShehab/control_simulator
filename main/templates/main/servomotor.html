{% extends 'main/layout.html' %} {% load static %} {% block head %}
<title>Servomotor Simulator</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta http-equiv="x-ua-compatible" content="ie=edge" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.min.js"></script>
<link href="{% static 'main/css/cred.css' %}" rel="stylesheet" />
<link href="{% static 'main/css/profile.css' %}" rel="stylesheet" />
<link href="{% static 'main/css/Layout.css' %}" rel="stylesheet" />
<link href="{% static 'main/css/simulator.css' %}" rel="stylesheet" />
<style>
	.flex-child {
		margin-top: 5%;
		flex: 0 70em;
	}

	.flex-child:first-child {
		border-right: 2px solid #28a745;
		padding: 3% 5% 2% 4%;
		margin-right: 20px;
	}
</style>
{% endblock head %} {% block body %} {{duplicateAssignment}} {% if assignment.riseTime %}
<div class="{{assignment.id}} assignPosition">
	<div class="assign_child">
		<h3>System Requirements</h3>
		Rise Time = {{assignment.riseTime}}s
		<br />
		Settling Time = {{assignment.setTime}}s
		<br />
		Percent overshoot = {{assignment.pOvershoot}}%
		<br />
		steady state error = {{assignment.Ess}}
		<br />
		<button class="button" onclick="closeReqForm({{assignment.id}});">Exit</button>
	</div>
</div>
{% else %}
<div class="{{assignment.id}} assignPosition">
	<div class="assign_child">
		<h3>Requirements Describtion</h3>
		<p>{{assignment.describtion}}</p>
		<br />
		<button class="button" onclick="closeReqForm({{assignment.id}});">Exit</button>
	</div>
</div>
{% endif %}
<div class="flex-container" style="display: flex">
	<div class="flex-child" id="simulatorForm" style="flex: 1">
		<form class="cred_form">
			{% if assignment %}
			<h5>
				Assignment: {{assignment.subject}}<button class="button" id="{{assignment.id}}" type="button" onclick="openReqForm({{assignment.id}});">
					Display Requirements
				</button>
			</h5>
			{% endif %}
			<h2 style="display: inline">Controller:</h2>
			<select class="cred" onchange="display();" id="selector">
				<option selected value="non">Uncompensated</option>
				<option value="P">P</option>
				<option value="PI">PI</option>
				<option value="PD">PD</option>
				<option value="PID">PID</option>
				<option value="lag">Lag</option>
				<option value="lead">Lead</option>
			</select>
			{% comment %} Dummy Form Temporary fix for some unknown bug {% endcomment %}
			<div id="dummy" style="display: none" class="option">
				<form class="cred_form" action="{% url 'servomotor' %}" method="POST">
					{% csrf_token %}
					<button class="button" type="submit" name="submit" value="submit">Submit</button>
				</form>
			</div>
                        <div id="non" class="option">
                                <form class="cred_form" action="{% url 'servomotor' %}" method="POST">
					{% csrf_token %}
                                        <div class="text1">
                                                <p class="input-bar">Set Point:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="p" value="1" />
                                        </div>
                                        <div class="text2">
                                                <p class="input-bar">Simulation Time:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="p" value="1" />
                                        </div>
					{% if assignment %}
					<button class="button" type="submit" name="submit" value="submit">Submit</button>
					{% endif %}
					<button class="button" type="submit" name="submit" value="simulate">Start</button>
					<input class="button" type="button" value="Reset" />
				</form>   
                        </div>
			<div id="P" style="display: none" class="option">
				<form class="cred_form" action="{% url 'servomotor' %}" method="POST">
					{% csrf_token %}
                                        <div class="text1">
                                                <p class="input-bar">Set Point:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="p" value="1" />
                                        </div>
                                        <div class="text2">
                                                <p class="input-bar">Simulation Time:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="p" value="1" />
                                        </div>
                                        <div class="text0">
                                                <p class="input-bar" style="margin-left: 10px;">P:</p>
                                                <input class="cred" type="number" step="0.00001" required name="p" placeholder="Enter a value" />
                                        </div>
					{% if assignment %}
					<button class="button" type="submit" name="submit" value="submit">Submit</button>
					{% endif %}
					<button class="button" type="submit" name="submit" value="simulate">Start</button>
					<input class="button" type="button" value="Reset" />
				</form>
			</div>
			<div id="PI" style="display: none" class="option">
				<form class="cred_form" action="{% url 'servomotor' %}" method="POST">
					{% csrf_token %}
                                        <div class="text1">
                                                <p class="input-bar">Set Point:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="p" value="1" />
                                        </div>
                                        <div class="text2">
                                                <p class="input-bar">Simulation Time:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="p" value="1" />
                                        </div>
                                        <br><br><br>
                                        <div class="text1">
                                                <p class="input-bar">P:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="p" />
                                        </div>
					<div class="text2">
                                                <p class="input-bar">I:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="i" />
                                        </div>
					
					{% if assignment %}
					<button class="button" type="submit" name="submit" value="submit">Submit</button>
					{% endif %}
					<button class="button" type="submit" name="submit" value="simulate">Start</button>
					<input class="button" type="button" value="Reset" />
				</form>
			</div>
			<div id="PD" style="display: none" class="option">
				<form class="cred_form" action="{% url 'servomotor' %}" method="POST">
					{% csrf_token %}
                                        <div class="text1">
                                                <p class="input-bar">Set Point:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="p" value="1" />
                                        </div>
                                        <div class="text2">
                                                <p class="input-bar">Simulation Time:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="p" value="1" />
                                        </div>
					<br><br><br>
                                        <div class="text1">
                                                <p class="input-bar">P:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="p" />
                                        </div>
					<div class="text2">
                                                <p class="input-bar">D:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="d" />
                                        </div>
					{% if assignment %}
					<button class="button" type="submit" name="submit" value="submit">Submit</button>
					{% endif %}
					<button class="button" type="submit" name="submit" value="simulate">Start</button>
					<input class="button" type="button" value="Reset" />
				</form>
			</div>
			<div id="PID" style="display: none" class="option">
				<form class="cred_form" action="{% url 'servomotor' %}" method="POST">
					{% csrf_token %}
                                        <div class="text1">
                                                <p class="input-bar">Set Point:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="p" value="1" />
                                        </div>
                                        <div class="text2">
                                                <p class="input-bar">Simulation Time:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="p" value="1" />
                                        </div>
                                        <br><br><br>
                                        <div class="text11">
                                                <p class="input-bar">P:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="p" />
                                        </div>
					<div class="text22">
                                                <p class="input-bar">I:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="i" />
                                        </div>
                                        <div class="text33">
                                                <p class="input-bar">D:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="d" />
                                        </div>
					{% if assignment %}
					<button class="button" type="submit" name="submit" value="submit">Submit</button>
					{% endif %}
					<button class="button" type="submit" name="submit" value="simulate">Start</button>
					<input class="button" type="button" value="Reset" />
				</form>
			</div>
			<div id="lag" style="display: none" class="option">
				<form class="cred_form" action="{% url 'servomotor' %}" method="POST">
                                        {% csrf_token %}
                                        <div class="text1">
                                                <p class="input-bar">Set Point:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="p" value="1" />
                                        </div>
                                        <div class="text2">
                                                <p class="input-bar">Simulation Time:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="p" value="1" />
                                        </div>
                                        <br><br><br>
                                        <div class="text11">
                                                <p class="input-bar">Zero:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="zero" />
                                        </div>
					<div class="text22">
                                                <p class="input-bar">Pole:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="pole" />
                                        </div>
                                        <div class="text33">
                                                <p class="input-bar">Gain:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="gain" />
                                        </div>
					{% if assignment %}
					<button class="button" type="submit" name="submit" value="submit">Submit</button>
					{% endif %}
					<button class="button" type="submit" name="submit" value="simulate">Start</button>
					<input class="button" type="button" value="Reset" />
				</form>
			</div>
			<div id="lead" style="display: none" class="option">
				<form class="cred_form" action="{% url 'servomotor' %}" method="POST">
                                        {% csrf_token %}
                                        <div class="text1">
                                                <p class="input-bar">Set Point:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="p" value="1" />
                                        </div>
                                        <div class="text2">
                                                <p class="input-bar">Simulation Time:</p>
                                                <input class="input-data" type="number" step="0.00001" required name="p" value="1" />
                                        </div>
					<br><br><br>
                                        <div class="text11">
                                                <p class="input-bar">Zero:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="zero" />
                                        </div>
					<div class="text22">
                                                <p class="input-bar">Pole:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="pole" />
                                        </div>
                                        <div class="text33">
                                                <p class="input-bar">Gain:</p>
                                                <input class="input-data" type="number" step="0.00001" required placeholder="Enter a value" name="gain" />
                                        </div>
					{% if assignment %}
					<button class="button" type="submit" name="submit" value="submit">Submit</button>
					{% endif %}
					<button class="button" type="button" onclick="sim()">Start</button>
					<input class="button" type="button" value="Reset" />
				</form>
			</div>
		</form>
	</div>
	<div class="flex-child" style="text-align: center">
		<div>
			<h1>System Response</h1>
			<canvas id="myChart"></canvas>
		</div>
	</div>
</div>
<div style="text-align: center">
	<a class="btn draw" href="{% url 'design'  %}?name=Servomotor">Design by Frequency</a>
</div>
<div class="desc" id="desc">
	<button id="descButton" class="descButton" onclick="run();">Show System Description<span class="arrowUp"></span></button>
	<div class="content">
		<iframe id="pdf" src="{% static 'main/pdf/test.pdf' %}"></iframe>
	</div>
</div>
<script src=" {% static 'main/script/chart.js' %}"></script>
<script src=" {% static 'main/script/student.js' %}"></script>
<script src=" {% static 'main/script/simulator.js' %}"></script>
<script>
	window.addEventListener("load", (event) => {
		if ("{{assignment.controller}}" != "") {
			document.getElementById("selector").value = "{{assignment.controller}}";
			display();
		}
	});
</script>
{% endblock body %}
